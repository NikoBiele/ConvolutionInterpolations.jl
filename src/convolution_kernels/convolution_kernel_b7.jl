# see 'docstring.jl' for documentation
const b7_coefs = Dict(
    # 6 equation septic, 7th order accurate
    :eq1 => [1//1, 0//1, -1173431//624240, 0//1, 922243//749088, 0//1, -7587149//14981760, 258097//1664640],
    :eq2 => [106117//124848, 834167//1248480, -1709177//624240, -119839//249696, 2712769//749088, -214769//83232, 11023027//14981760, -384481//4993920], 
    :eq3 => [30587//2448, -35785081//1248480, 376423//15606, -126025//14688, 794957//1498176, 13571//27744, -796241//5992704, 105457//9987840], 
    :eq4 => [-2861771//41616, 325209229//2496960, -129943051//1248480, 22764947//499392, -17736439//1498176, 303937//166464, -4645469//29963520, 167719//29963520],
    :eq5 => [9845663//124848, -908278361//7490880, 99126901//1248480, -14343661//499392, 9292729//1498176, -399533//499392, 1710679//29963520, -52123//29963520], 
    :eq6 => [9711//1156, -29133//2890, 119769//23120, -20501//13872, 14027//55488, -1079//41616, 44239//29963520, -1079//29963520]
)
const b7_coefs_d1 = Dict(
    # 6 equation septic, 7th order accurate
    :eq1 => [0//1*1//1, 1//1*0//1, 2//1*-1173431//624240, 3//1*0//1, 4//1*922243//749088, 5//1*0//1, 6//1*-7587149//14981760, 7//1*258097//1664640],
    :eq2 => [0//1*106117//124848, 1//1*834167//1248480, 2//1*-1709177//624240, 3//1*-119839//249696, 4//1*2712769//749088, 5//1*-214769//83232, 6//1*11023027//14981760, 7//1*-384481//4993920], 
    :eq3 => [0//1*30587//2448, 1//1*-35785081//1248480, 2//1*376423//15606, 3//1*-126025//14688, 4//1*794957//1498176, 5//1*13571//27744, 6//1*-796241//5992704, 7//1*105457//9987840], 
    :eq4 => [0//1*-2861771//41616, 1//1*325209229//2496960, 2//1*-129943051//1248480, 3//1*22764947//499392, 4//1*-17736439//1498176, 5//1*303937//166464, 6//1*-4645469//29963520, 7//1*167719//29963520],
    :eq5 => [0//1*9845663//124848, 1//1*-908278361//7490880, 2//1*99126901//1248480, 3//1*-14343661//499392, 4//1*9292729//1498176, 5//1*-399533//499392, 6//1*1710679//29963520, 7//1*-52123//29963520], 
    :eq6 => [0//1*9711//1156, 1//1*-29133//2890, 2//1*119769//23120, 3//1*-20501//13872, 4//1*14027//55488, 5//1*-1079//41616, 6//1*44239//29963520, 7//1*-1079//29963520]
)
const b7_coefs_d2 = Dict(
    # 6 equation septic, 7th order accurate
    :eq1 => [0//1*1//1, 0//1*1//1*0//1, 2//1*-1173431//624240, 2//1*3//1*0//1, 3//1*4//1*922243//749088, 4//1*5//1*0//1, 5//1*6//1*-7587149//14981760, 6//1*7//1*258097//1664640],
    :eq2 => [0//1*106117//124848, 0//1*1//1*834167//1248480, 2//1*-1709177//624240, 2//1*3//1*-119839//249696, 3//1*4//1*2712769//749088, 4//1*5//1*-214769//83232, 5//1*6//1*11023027//14981760, 6//1*7//1*-384481//4993920], 
    :eq3 => [0//1*30587//2448, 0//1*1//1*-35785081//1248480, 2//1*376423//15606, 2//1*3//1*-126025//14688, 3//1*4//1*794957//1498176, 4//1*5//1*13571//27744, 5//1*6//1*-796241//5992704, 6//1*7//1*105457//9987840], 
    :eq4 => [0//1*-2861771//41616, 0//1*1//1*325209229//2496960, 2//1*-129943051//1248480, 2//1*3//1*22764947//499392, 3//1*4//1*-17736439//1498176, 4//1*5//1*303937//166464, 5//1*6//1*-4645469//29963520, 6//1*7//1*167719//29963520],
    :eq5 => [0//1*9845663//124848, 0//1*1//1*-908278361//7490880, 2//1*99126901//1248480, 2//1*3//1*-14343661//499392, 3//1*4//1*9292729//1498176, 4//1*5//1*-399533//499392, 5//1*6//1*1710679//29963520, 6//1*7//1*-52123//29963520], 
    :eq6 => [0//1*9711//1156, 0//1*1//1*-29133//2890, 2//1*119769//23120, 2//1*3//1*-20501//13872, 3//1*4//1*14027//55488, 4//1*5//1*-1079//41616, 5//1*6//1*44239//29963520, 6//1*7//1*-1079//29963520]
)
const b7_coefs_d3 = Dict(
    # 6 equation septic, 7th order accurate
    :eq1 => [0//1*1//1, 0//1*1//1*0//1, 0//1*2//1*-1173431//624240, 2//1*3//1*0//1, 2//1*3//1*4//1*922243//749088, 3//1*4//1*5//1*0//1, 4//1*5//1*6//1*-7587149//14981760, 5//1*6//1*7//1*258097//1664640],
    :eq2 => [0//1*106117//124848, 0//1*1//1*834167//1248480, 0//1*2//1*-1709177//624240, 2//1*3//1*-119839//249696, 2//1*3//1*4//1*2712769//749088, 3//1*4//1*5//1*-214769//83232, 4//1*5//1*6//1*11023027//14981760, 5//1*6//1*7//1*-384481//4993920], 
    :eq3 => [0//1*30587//2448, 0//1*1//1*-35785081//1248480, 0//1*2//1*376423//15606, 2//1*3//1*-126025//14688, 2//1*3//1*4//1*794957//1498176, 3//1*4//1*5//1*13571//27744, 4//1*5//1*6//1*-796241//5992704, 5//1*6//1*7//1*105457//9987840], 
    :eq4 => [0//1*-2861771//41616, 0//1*1//1*325209229//2496960, 0//1*2//1*-129943051//1248480, 2//1*3//1*22764947//499392, 2//1*3//1*4//1*-17736439//1498176, 3//1*4//1*5//1*303937//166464, 4//1*5//1*6//1*-4645469//29963520, 5//1*6//1*7//1*167719//29963520],
    :eq5 => [0//1*9845663//124848, 0//1*1//1*-908278361//7490880, 0//1*2//1*99126901//1248480, 2//1*3//1*-14343661//499392, 2//1*3//1*4//1*9292729//1498176, 3//1*4//1*5//1*-399533//499392, 4//1*5//1*6//1*1710679//29963520, 5//1*6//1*7//1*-52123//29963520], 
    :eq6 => [0//1*9711//1156, 0//1*1//1*-29133//2890, 0//1*2//1*119769//23120, 2//1*3//1*-20501//13872, 2//1*3//1*4//1*14027//55488, 3//1*4//1*5//1*-1079//41616, 4//1*5//1*6//1*44239//29963520, 5//1*6//1*7//1*-1079//29963520]
)
const b7_coefs_d4 = Dict(
    # 6 equation septic, 7th order accurate
    :eq1 => [0//1*1//1, 0//1*1//1*0//1, 0//1*2//1*-1173431//624240, 0//1*2//1*3//1*0//1, 2//1*3//1*4//1*922243//749088, 2//1*3//1*4//1*5//1*0//1, 3//1*4//1*5//1*6//1*-7587149//14981760, 4//1*5//1*6//1*7//1*258097//1664640],
    :eq2 => [0//1*106117//124848, 0//1*1//1*834167//1248480, 0//1*2//1*-1709177//624240, 0//1*2//1*3//1*-119839//249696, 2//1*3//1*4//1*2712769//749088, 2//1*3//1*4//1*5//1*-214769//83232, 3//1*4//1*5//1*6//1*11023027//14981760, 4//1*5//1*6//1*7//1*-384481//4993920], 
    :eq3 => [0//1*30587//2448, 0//1*1//1*-35785081//1248480, 0//1*2//1*376423//15606, 0//1*2//1*3//1*-126025//14688, 2//1*3//1*4//1*794957//1498176, 2//1*3//1*4//1*5//1*13571//27744, 3//1*4//1*5//1*6//1*-796241//5992704, 4//1*5//1*6//1*7//1*105457//9987840], 
    :eq4 => [0//1*-2861771//41616, 0//1*1//1*325209229//2496960, 0//1*2//1*-129943051//1248480, 0//1*2//1*3//1*22764947//499392, 2//1*3//1*4//1*-17736439//1498176, 2//1*3//1*4//1*5//1*303937//166464, 3//1*4//1*5//1*6//1*-4645469//29963520, 4//1*5//1*6//1*7//1*167719//29963520],
    :eq5 => [0//1*9845663//124848, 0//1*1//1*-908278361//7490880, 0//1*2//1*99126901//1248480, 0//1*2//1*3//1*-14343661//499392, 2//1*3//1*4//1*9292729//1498176, 2//1*3//1*4//1*5//1*-399533//499392, 3//1*4//1*5//1*6//1*1710679//29963520, 4//1*5//1*6//1*7//1*-52123//29963520], 
    :eq6 => [0//1*9711//1156, 0//1*1//1*-29133//2890, 0//1*2//1*119769//23120, 0//1*2//1*3//1*-20501//13872, 2//1*3//1*4//1*14027//55488, 2//1*3//1*4//1*5//1*-1079//41616, 3//1*4//1*5//1*6//1*44239//29963520, 4//1*5//1*6//1*7//1*-1079//29963520]
)

function (::ConvolutionKernel{:b7,DO})(s::T) where {T,DO} # 7th order accurate 7th degree
    b7_coefs_in = if DO == 0
        b7_coefs
    elseif DO == 1
        b7_coefs_d1
    elseif DO == 2
        b7_coefs_d2
    elseif DO == 3
        b7_coefs_d3
    elseif DO == 4
        b7_coefs_d4
    else
        error("kernel :b7 supports differentiation orders 0, 1, 2, 3, 4, but got $DO")
    end
    s_abs = abs(s)
    if s_abs < 1.0
        return horner(s_abs, b7_coefs_in, :eq1, T, DO) * (isodd(DO) ? T(sign(s)) : one(T))
    elseif s_abs < 2.0
        return horner(s_abs, b7_coefs_in, :eq2, T, DO) * (isodd(DO) ? T(sign(s)) : one(T))
    elseif s_abs < 3.0
        return horner(s_abs, b7_coefs_in, :eq3, T, DO) * (isodd(DO) ? T(sign(s)) : one(T))
    elseif s_abs < 4.0
        return horner(s_abs, b7_coefs_in, :eq4, T, DO) * (isodd(DO) ? T(sign(s)) : one(T))
    elseif s_abs < 5.0
        return horner(s_abs, b7_coefs_in, :eq5, T, DO) * (isodd(DO) ? T(sign(s)) : one(T))
    elseif s_abs < 6.0
        return horner(s_abs, b7_coefs_in, :eq6, T, DO) * (isodd(DO) ? T(sign(s)) : one(T))
    else
        return zero(T)
    end
end